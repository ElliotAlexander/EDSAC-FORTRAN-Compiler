      SUBROUTINE GETEA(VN)
      COMMON/CB01/DCSL(10),BETA(10),SNA(10),C0(10),X0ALO(10),
     XX0SIO(10),D(10),VB(10),CM0(10),SND(10)
      COMMON/CB05/NSET,ISET,NSTEP,ISTEP
      COMMON/CB06/C1,C2,C3,C4,C5,C6,C7,VINV,EINV,VSTART,VEND
      COMMON/CB07/PHIS,VI,PSIL,VA,VALOX,VGATE,VSIOX
      COMMON/CB08/EA,EPD,B,EXPBV,EP0,ES,EALOX,ESO
C      ROUTINE TO CALCULATE FIELDS AT THE AQUEOUS/SURFACE LAYER INTERFACE
      EA=C1*SINH(BETA(ISET)*VN/2.0)
      EPD=C2*EA
      CALL CK(16,EA    ,'EA    ','GETEA ')
      CALL CK(17,EPD   ,'EPD   ','GETEA ')
      RETURN
      END
C
C******
C
C
      SUBROUTINE AQPROF
      COMMON/CB01/DCSL(10),BETA(10),SNA(10),C0(10),X0ALO(10),
     XX0SIO(10),D(10),VB(10),CM0(10),SND(10)
      COMMON/CB02/Q,DC0,DCSI,DCALO,DCSIO,CCI,DCAQ0
      COMMON/CB05/NSET,ISET,NSTEP,ISTEP
      COMMON/CB06/C1,C2,C3,C4,C5,C6,C7,VINV,EINV,VSTART,VEND
      COMMON/CB07/PHIS,VI,PSIL,VA,VALOX,VGATE,VSIOX
      COMMON/CB10/VAQ(100,10),EAQ(100,10),QAQ(100,10),XAQ(100),LIMAQ
      COMMON/CB13/C8,C9,C10,C11,C12,C13,C14,C15,C16,C17,C18,C19,C20,C21
      COMMON/CB23/DCSLMN,BETAMN,SNAMN,C0MN,X0ALMN,X0SIMN,DMN,
     XVBMN,CM0MN,SNDMN
C      ROUTINE TO CALCULATE CHARGE DENSITY, ELECTRIC FIELD AND
C      VOLTAGE PROFILES IN THE AQUEOUS PHASE, GIVEN THE BOUNDARY
C      CONDITION VA ESTABLISHED BY SUBROUTINE CLOSLP
C      MINIMUM DISTANCE INTO AQUEOUS PHASE BEFORE
C      PROFILES DECAY - SEE NOTES 'COMPUTATIONAL BODGES I'
      XMAXAQ=C14
      XINC=XMAXAQ/FLOAT(LIMAQ)
C      CALCULATE HORRIBLE CONSTANT
      T=BETA(ISET)*VA/4.0
      T=TANH(T)
C      SET UP LOOP TO CALCULATE VOLTAGE, FIELD AND CHARGE
C      PROFILES, AND STORE THEM
      DO 100 I=1,LIMAQ
C      CALCULATE X POSITION
      X=FLOAT(I-1)*XINC
      C7X=C7*X
      TVAQC8=GVAQC8(C7X,T)
C      VOLTAGE
      VAQ(I,ISET)=TVAQC8
C      FIELD
      EAQ(I,ISET)=C1*SINH((BETA(ISET)*TVAQC8)/2.0)
C      CHARGE DENSITY
      QAQ(I,ISET)=C10*SINH(BETA(ISET)*TVAQC8)
C      ABSCISSA
C      IF FIRST TIME ROUND, LOAD ABSCISSA ARRAY
      IF(ISET.EQ.1)XAQ(I)=X
100   CONTINUE
C      SO ALL PROFILES NICELY TUCKED UP IN DATA ARRAYS
      RETURN
      END
C
C******
C
C
      FUNCTION GVAQC8(X,T)
      COMMON/CB13/C8,C9,C10,C11,C12,C13,C14,C15,C16,C17,C18,C19,C20,C21
C      FUNCTION TO RETURN THE VOLTAGE AS A FUNCTION OF
C      DISTANCE IN THE AQUEOUS PHASE
C      FULL EXPRESSION IS GIVEN BY EQN 1.8 OF NOTES
C      IF EXP(X) >> T, SIMPLIFIED EXPRESSION POSSIBLE
C      IE IF X >> LN (1.0E17) * T, SIMPLIFIED .....
C      LN(1.0E17) = 39.143945
      DATA FF/39.143945/
      GVAQC8=0.0
      IF(X.GT.(FF+LOG(ABS(T))))RETURN
C      NO, SO USE FULL EXPRESSION
      EXPX=ADBEXP(X)
      GVAQC8=C8*LOG((EXPX+T)/(EXPX-T))
      RETURN
      END
C
C******
C
C
      SUBROUTINE AQENER
      COMMON/CB01/DCSL(10),BETA(10),SNA(10),C0(10),X0ALO(10),
     XX0SIO(10),D(10),VB(10),CM0(10),SND(10)
      COMMON/CB05/NSET,ISET,NSTEP,ISTEP
      COMMON/CB07/PHIS,VI,PSIL,VA,VALOX,VGATE,VSIOX
      COMMON/CB13/C8,C9,C10,C11,C12,C13,C14,C15,C16,C17,C18,C19,C20,C21
      COMMON/CB17/TOTUAQ,TOTUSL,TOTUSI,UMIN,UTOT
C      ROUTINE TO CALCULATE THE TOTAL ELECTROSTATIC ENERGY
C      IN THE AQUEOUS PHASE AS A FUNCTION OF THE INTERFACE VOLTAGE, VA.
      S=BETA(ISET)*VA/4.0
      S=SINH(S)
      TOTUAQ=C11*S*S
      RETURN
      END
C
C******
C
C
