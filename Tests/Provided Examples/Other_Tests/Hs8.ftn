      SUBROUTINE OUTPUT
C
C      *** NOTE THAT ALL THE CODE PERTAINING TO THE SILICON PHASE
C      IS REDUNDANT. I DECIDED NOT TO PLOT IT, AS ITS
C      ONLY DEPLETION APPROXIMATION ANYWAY, AND IT COCKS
C      UP THE LAYOUT IF D IS THE VARIABLE PARAMETER.
C      (IT GETS COCKED UP ANYWAY IF D IS THE VARIABLE PARAMETER,
C      BUT NOT SO BADLY) ***
C
C      ROUTINE TO OUTPUT THE FINAL RESULTS OF ALL THIS MESS
      CALL OUTINT
C      CLOSE GRAPHICS
      CALL PLOT(30.0,30.0,999)
C      AND DUMP THE ANSWERS
      WRITE(1,1000)
1000  FORMAT(7H OUTPUT)
      CALL PANIC(0)
      RETURN
      END
C
C******
C
C
      SUBROUTINE GLIM2(ARR,ARRMAX,ARRMIN)
      COMMON/CB05/NSET,ISET,NSTEP,ISTEP
      DIMENSION ARR(100,10)
C      ROUTINE TO CALCULATE THE MAXIMUM AND MINIMUM VALUES OF THE DATA
C      CONTAINED IN THE ARRAY ARR.
C      EACH CONTOUR CONTAINS LIM POINTS, AND THE NUMBER OF CONTOURS
C      IS GIVEN BY ISET.
C      THERE IS ALWAYS AT LEAST ONE CONTOUR.
C      INITIALISE DUMMY ARRAY SIZE
      DATA LIM/100/
C      INITIALISE MAX AND MIN POINTERS
      ARRMAX=ARR(1,1)
      ARRMIN=ARR(1,1)
C      SET UP LOOP TO GO THROUGH ONE CONTOUR SET AT A TIME
      DO 100 I=1,ISET
C      SET UP LOOP TO GO THROUGH ONE PROFILE AT A TIME
      DO 200 J=1,LIM
      ARRMAX=AMAX1(ARRMAX,ARR(J,I))
      ARRMIN=AMIN1(ARRMIN,ARR(J,I))
200   CONTINUE
100   CONTINUE
      RETURN
      END
C
C******
C
C
      SUBROUTINE OUTINT
      COMMON/CB05/NSET,ISET,NSTEP,ISTEP
      COMMON/CB24/PSILAR(12),VAAR(12)
      DIMENSION DUM(4),ABSCIS(12),IXTIT(4),IYTIT(5)
      DIMENSION YDUM(12)
C      ROUTINE TO OUTPUT THE AQUEOUS PHASE INTERFACE VOLTAGE (VA)
C      AND THE SURFACE LAYER VOLTAGE (PSIL) AS A FUNCTION OF ISET
C      OUTPUT WILL CONSIST OF THREE CURVES, VA, PSIL
C      AND (VA+PSIL) PLOTTED ON THE SAME AXES
      DATA IXTIT(1)/4HPARA/,IXTIT(2)/4HMETE/
      DATA IXTIT(3)/4HR SE/,IXTIT(4)/4HT   /
      DATA LIXTIT/16/
      DATA IYTIT(1)/4HINTE/,IYTIT(2)/4HRFAC/
      DATA IYTIT(3)/4HIAL /,IYTIT(4)/4HVOLT/
      DATA IYTIT(5)/4HAGES/
      DATA LIYTIT/20/
C      LENGTH OF X AXIS
      XAX=30.0
C      LEBGTH OF Y AXIS
      YAX=25.0
C      HEIGHT OF CHARACTERS
      CHARHT=0.35
C      CALCULATE MAXIMUM AND MINIMUM EXCURSIONS
      CALL EXCUR(VMAX,VMIN)
C      LOAD INTO DUMMY SCALING ARRAY
      DUM(1)=VMIN
      DUM(2)=VMAX
C      AND SCALE
      CALL SCALE(DUM,YAX,2,1)
C      LOAD ABSCISSA ARRAY
      DO 100 I=1,ISET
      ABSCIS(I)=FLOAT(I)
100   CONTINUE
C      AND SCALE ABSCISSA
      CALL SCALE(ABSCIS,XAX,ISET,1)
C      UNLOAD SCALING INFORMATION FROM SCALED ARRAYS
      ISET1=ISET+1
      ISET2=ISET+2
      FIRSTX=ABSCIS(ISET1)
      DELTAX=ABSCIS(ISET2)
      FIRSTY=DUM(3)
      DELTAY=DUM(4)
C      AND INSERT SCALING INFORMATION INTO Y DATA ARRAYS
      PSILAR(ISET1)=FIRSTY
      PSILAR(ISET2)=DELTAY
      VAAR(ISET1)=FIRSTY
      VAAR(ISET2)=DELTAY
      YDUM(ISET1)=FIRSTY
      YDUM(ISET2)=DELTAY
C      LH Y AXIS
      CALL AXIS(0.0,0.0,IYTIT,LIYTIT,YAX,90.0,FIRSTY,DELTAY)
C      BOTTOM X AXIS
      CALL PLOT(0.0,0.0,3)
      CALL PLOT(XAX,0.0,2)
C      RH Y AXIS
      CALL AXIS(XAX,0.0,IYTIT,-LIYTIT,YAX,90.0,FIRSTY,DELTAY)
C      TOP X AXIS
      CALL PLOT(0.0,YAX,3)
      CALL PLOT(XAX,YAX,2)
C      DRAW VA CURVE
      CALL LINE(ABSCIS,VAAR,ISET,1,1,3)
C      DRAW PSIL CURVE
      CALL LINE(ABSCIS,PSILAR,ISET,1,1,4)
C      DRAW SUM : FIRST ADD THE TWO TOGETHER IN VAAR, THEN PLOT
      DO 200 I=1,ISET
      VAAR(I)=VAAR(I)+PSILAR(I)
200   CONTINUE
      CALL LINE(ABSCIS,VAAR,ISET,1,1,11)
C      CALIBRATE LOWER X AXIS
C      TICK MARKS
C      GET Y COORDINATE OF BOTTOM X AXIS AND LOAD INTO DUMMY
CV     Y ARRAY
      DO 600 I=1,ISET
      YDUM(I)=FIRSTY
600   CONTINUE
      CALL LINE(ABSCIS,YDUM,ISET,1,-1,13)
C      GET Y COORDINATE OF TOP AXIS
      YTOP=FIRSTY+(DELTAY*YAX)
C      LOAD INTO DUMMY Y ARRAY
      DO 300 I=1,ISET
      YDUM(I)=YTOP
300   CONTINUE
C      AND TOP X AXIS TICK MARKS
      CALL LINE(ABSCIS,YDUM,ISET,1,-1,13)
C      X TITLE OFFSET
      XOFF=(XAX-(CHARHT*FLOAT(LIXTIT)))/2.0
C      Y TITLE OFFSET
      YOFF=3.0*CHARHT
C      TOP TITLE
      CALL SYMBOL(XOFF,(YAX+YOFF),CHARHT,IXTIT,0.0,LIXTIT)
C      BOTTOM TITLE
      CALL SYMBOL(XOFF,-(YOFF+CHARHT),CHARHT,IXTIT,0.0,LIXTIT)
C      CALIBRATE BOTTOM AXIS
      Y=0.4-YOFF
      DO 400 I=1,ISET
      X=FIRSTX+(ABSCIS(I)/DELTAX)
      CALL NUMBER(X,Y,CHARHT,ABSCIS(I),0.0,-1)
400   CONTINUE
C      TOP AXIS
      Y=CHARHT+YAX
      DO 500 I=1,ISET
      X=FIRSTX+(ABSCIS(I)/DELTAX)
      CALL NUMBER(X,Y,CHARHT,ABSCIS(I),0.0,-1)
500   CONTINUE
C      CALCULATE PLOTTER COORDINATES OF V = 0.0 LINE
      Y0=-FIRSTY/DELTAY
C      DRAW DASHED LINE AT V = 0.0
C      IF IT IS ECLOSED BY THE GRAPH
      CALL PLOT(0.0,Y0,3)
      IF((Y0.GE.0.0).AND.(Y0.LE.YAX))CALL DASHP(XAX,Y0,0.5)
C      DRAW TICK MARKS ON V = 0.0 LINE
      DO 700 I=1,ISET
      YDUM(I)=0.0
700   CONTINUE
      CALL LINE(ABSCIS,YDUM,ISET,1,-1,13)
C      DRAW KEY
      CALL DRKEY(YAX)
C      MOVE PEN TO POSITION TO START NEXT PLOT, AND ESTABLISH
C      NEW ORIGIN
      CALL PLOT((XAX+10.0),0.0,-3)
C      DRAW THE PROFILES OF EACH PHASE SEPERATELY
      CALL DRPHAS
      RETURN
      END
C
C******
C
C
      SUBROUTINE DRKEY(YAX)
C      ROUTINE TO DRAW THE SYMBOL KEYS ON THE
C      INTERFACE VOLTAGE GRAPH
      DIMENSION IVA(4),IPSIL(4),ISUM(4),IVOL(2)
      DATA IVA(1)/4HAQUE/,IVA(2)/4HOUS /,IVA(3)/4H PHA/
      DATA IVA(4)/4HSE  /,LIVA/16/
      DATA IPSIL(1)/4HSURF/,IPSIL(2)/4HACE /,IPSIL(3)/4H LAY/
      DATA IPSIL(4)/4HER  /,LIPSIL/16/
      DATA ISUM(1)/4HTOTA/,ISUM(2)/4HL VO/,ISUM(3)/4HLTAG/
      DATA ISUM(4)/4HE   /,LISUM/16/
      DATA IVOL(1)/4HVOLT/,IVOL(2)/4HAGE /,LIVOL/8/
      DATA CH/0.35/
      X1=-9.0
      X2=-8.0
      Y1=15.0
      Y2=14.0
      Y3=13.0
      Y4=12.0
      Y5=11.0
      CALL SYMBOL(X1,Y1,CH,3     ,0.0,-1    )
      CALL SYMBOL(X2,Y1,CH,IVA   ,0.0,LIVA  )
      CALL SYMBOL(X2,Y2,CH,IVOL  ,0.0,LIVOL )
      CALL SYMBOL(X1,Y3,CH,4     ,0.0,-1    )
      CALL SYMBOL(X2,Y3,CH,IPSIL ,0.0,LIPSIL)
      CALL SYMBOL(X2,Y4,CH,IVOL  ,0.0,LIVOL )
      CALL SYMBOL(X1,Y5,CH,11    ,0.0,-1    )
      CALL SYMBOL(X2,Y5,CH,ISUM  ,0.0,LISUM )
      X1=5.0
      X2=6.0
      X3=11.6
      Y1=YAX+5.0
      Y2=YAX+4.0
      Y3=YAX+3.0
      CALL SYMBOL(X1,Y1,CH,3     ,0.0,-1    )
      CALL SYMBOL(X2,Y1,CH,IVA   ,0.0,LIVA  )
      CALL SYMBOL(X3,Y1,CH,IVOL  ,0.0,LIVOL )
      CALL SYMBOL(X1,Y2,CH,4     ,0.0,-1    )
      CALL SYMBOL(X2,Y2,CH,IPSIL ,0.0,LIPSIL)
      CALL SYMBOL(X3,Y2,CH,IVOL  ,0.0,LIVOL )
      CALL SYMBOL(X1,Y3,CH,11    ,0.0,-1    )
      CALL SYMBOL(X2,Y3,CH,ISUM  ,0.0,LISUM )
      RETURN
      END
C
C******
C
C
      SUBROUTINE EXCUR(VMAX,VMIN)
      COMMON/CB05/NSET,ISET,NSTEP,ISTEP
      COMMON/CB24/PSILAR(12),VAAR(12)
C      ROUTINE TO RETURN THE MAXIMUM AND MINIMUM VALUES OF
C      THE INTERFACIAL VOLTAGES FROM ALL THE PARAMETER SETS
C      INCLUDE THE SUM OF THE TWO, AS THIS HAS ALSO TO BE PLOTTED
C      INITIALISE EXTREMA
      VMAX=VAAR(1)
      VMIN=VAAR(1)
C      AND GET ON WITH IT
      DO 100 I=1,ISET
      VSUM=VAAR(I)+PSILAR(I)
      VMAX=AMAX1(VAAR(I),PSILAR(I),VSUM,VMAX)
      VMIN=AMIN1(VAAR(I),PSILAR(I),VSUM,VMIN)
100   CONTINUE
      RETURN
      END
C
C******
C
C
      SUBROUTINE DRPHAS
      COMMON/CB05/NSET,ISET,NSTEP,ISTEP
     XXSLLOC,XMAXSL
      COMMON/CB11/VSL(100,10),ESL(100,10),QSL(100,10),XSL(100),LIMSL,
      COMMON/CB10/VAQ(100,10),EAQ(100,10),QAQ(100,10),XAQ(100),LIMAQ
      COMMON/CB12/VSI(100,10),ESI(100,10),QSI(100,10),XSI(100),LIMSI,
     XXSILOC,XMAXSI
C      ROUTINE TO DUMP OUT THE CONTENTS OF THE SOLUTION ARRAYS
C      ONE AT A TIME, GRAPHICALLY.
C      AQUEOUS VOLTAGE
      CALL OUTARR(VAQ,XAQ,LIMAQ,ISET,1)
C      SURFACE LAYER VOLTAGE
      CALL OUTARR(VSL,XSL,LIMSL,ISET,2)
C      AQUEOUS FIELD
      CALL OUTARR(EAQ,XAQ,LIMAQ,ISET,3)
C      SURFACE LAYER FIELD
      CALL OUTARR(ESL,XSL,LIMSL,ISET,4)
C      AQUEOUS CHARGE DENSITY
      CALL OUTARR(QAQ,XAQ,LIMAQ,ISET,5)
C      SURFACE LAYER CHARGE DENSITY
      CALL OUTARR(QSL,XSL,LIMAQ,ISET,6)
      RETURN
      END
C
C******
C
C
      SUBROUTINE OUTARR(YARR,XARR,LIM1,LIM2,ICODE)
      COMMON/CB05/NSET,ISET,NSTEP,ISTEP
      COMMON/CB21/XDAT(102),YDAT(102)
      DIMENSION YARR(LIM1,LIM2),XARR(LIM1),DUM(4),T(10,6),LT(6),XLAB(2)
      INTEGER XLAB
      INTEGER T
      DATA T(1,1)/4HAQUE/,T(2,1)/4HOUS /,T(3,1)/4HVOLT/,T(4,1)/4HAGE /
      DATA T(5,1)/4H(V) /
      DATA T(1,2)/4HSURF/,T(2,2)/4HACE /,T(3,2)/4HLAYE/,T(4,2)/4HR VO/
      DATA T(5,2)/4HLTAG/,T(6,2)/4HE (V/,T(7,2)/4H)   /
      DATA T(1,3)/4HAQUE/,T(2,3)/4HOUS /,T(3,3)/4HFIEL/,T(4,3)/4HD (V/
      DATA T(5,3)/4H/M) /
      DATA T(1,4)/4HSURF/,T(2,4)/4HACE /,T(3,4)/4HLAYE/,T(4,4)/4HR FI/
      DATA T(5,4)/4HELD /,T(6,4)/4H(V/M/,T(7,4)/4H)   /
      DATA T(1,5)/4HAQUE/,T(2,5)/4HOUS /,T(3,5)/4HCHAR/,T(4,5)/4HGE D/
      DATA T(5,5)/4HENSI/,T(6,5)/4HTY (/,T(7,5)/4HC/M*/,T(8,5)/4H*3) /
      DATA T(1,6)/4HSURF/,T(2,6)/4HACE /,T(3,6)/4HLAYE/,T(4,6)/4HR CH/
      DATA T(5,6)/4HARGE/,T(6,6)/4H DEN/,T(7,6)/4HSITY/,T(8,6)/4H (C//
      DATA T(9,6)/4HM**3/,T(10,6)/4H)   /
      DATA LT/19,25,20,25,31,37/
      DATA XAX/25.0/,YAX/20.0/
      DATA XLAB(1)/4HMETR/,XLAB(2)/4HES  /
      DATA LXLAB/6/
C      ROUTINE TO PLOT A SINGLE SET OF PROFILES HELD IN THE
C      ARRAY YARR
C      GET MAXIMUM AND MINIMUM VALUE OF THE PROFILES
      CALL GLIM2(YARR,ARRMAX,ARRMIN)
C      LOAD INTO DUMMY ARRAY TO BE SCALED BY CALCOMP SOFTWARE
      DUM(1)=ARRMAX
      DUM(2)=ARRMIN
C      AND SCALE
      CALL SCALE(DUM,YAX,2,1)
C      AND DRAW LH Y AXIS
      CALL AXIS(0.0,0.0,T(1,ICODE),LT(ICODE),YAX,90.0,DUM(3),DUM(4))
C      RH Y AXIS
      CALL AXIS(XAX,0.0,T(1,ICODE),-LT(ICODE),YAX,90.0,DUM(3),DUM(4))
C      LOAD SCALING FACTORS INTO Y PLOTTING ARRAY
      YDAT(101)=DUM(3)
      YDAT(102)=DUM(4)
C      LOAD X AXIS DATA INTO PLOTTING ARRAY
      DO 100 I=1,LIM1
      XDAT(I)=XARR(I)
100   CONTINUE
C      SCALE IT
      CALL SCALE(XDAT,XAX,LIM1,1)
C      BOTTOM X AXIS
      CALL AXIS(0.0,0.0,XLAB,-LXLAB,XAX,0.0,XDAT(101),XDAT(102))
C      TOP X AXIS
      CALL AXIS(0.0,YAX,XLAB,LXLAB,XAX,0.0,XDAT(101),XDAT(102))
C      PLOT THE CONTOURS
      DO 200 I=1,ISET
      CALL DRPROF(YARR,LIM1,LIM2,I)
200   CONTINUE
C      MOVE PEN TO POSITION TO START A NEW PLOT, AND ESTABLISH A
C      NEW ORIGIN
      CALL PLOT((XAX+10.0),0.0,-3)
      RETURN
      END
C
C******
C
C
      SUBROUTINE DRPROF(YARR,LIM1,LIM2,ICONT)
      COMMON/CB21/XDAT(102),YDAT(102)
C      ROUTINE TO DRAW CONTOUR ICONT, HELD INT
C      ARRAY YARR
      DIMENSION YARR(LIM1,LIM2)
C      UNLOAD CONTOUR FROM STORAGE ARRAY INTO
C      PLOTTING ARRAY
      DO 100 I=1,LIM1
      YDAT(I)=YARR(I,ICONT)
100   CONTINUE
C      (SCALE FACTORS ARE ALREADY IN YDAT, PUT THERE BY S/R OUTARR)
C      SO PLOT IT
      CALL LINE(XDAT,YDAT,LIM1,1,0,0)
      RETURN
      END
C
C******
C
C
